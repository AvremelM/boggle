parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"KA2S":[function(require,module,exports) {
var t=function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,r,e,n){var o=r&&r.prototype instanceof v?r:v,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return N()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=_(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=h(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function h(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}t.wrap=u;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={};function v(){}function d(){}function g(){}var m={};m[i]=function(){return this};var w=Object.getPrototypeOf,L=w&&w(w(G([])));L&&L!==e&&n.call(L,i)&&(m=L);var x=g.prototype=v.prototype=Object.create(m);function E(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function b(t){var r;this._invoke=function(e,o){function i(){return new Promise(function(r,i){!function r(e,o,i,a){var c=h(t[e],t,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?Promise.resolve(f.__await).then(function(t){r("next",t,i,a)},function(t){r("throw",t,i,a)}):Promise.resolve(f).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,a)})}a(c.arg)}(e,o,r,i)})}return r=r?r.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,_(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function j(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function O(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function G(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:N}}function N(){return{value:r,done:!0}}return d.prototype=x.constructor=g,g.constructor=d,g[c]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===d||"GeneratorFunction"===(r.displayName||r.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},E(b.prototype),b.prototype[a]=function(){return this},t.AsyncIterator=b,t.async=function(r,e,n,o){var i=new b(u(r,e,n,o));return t.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},E(x),x[c]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=G,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),O(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;O(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:G(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}},t}("object"==typeof module?module.exports:{});try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}
},{}],"CfsL":[function(require,module,exports) {
(()=>{"use strict";const t=100,e=500;let n=null,o=null,u=0,c=0,l=null,s=null;"function"!=typeof window.CustomEvent&&(window.CustomEvent=((t,e)=>{e=e||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}),window.CustomEvent.prototype=window.Event.prototype),document.addEventListener("touchstart",function(t){const e=document.getElementById("board");e&&e.contains(t.target)||(s=t.target,l=Date.now(),n=t.touches[0].clientX,o=t.touches[0].clientY,u=0,c=0)},!1),document.addEventListener("touchmove",function(t){n&&o&&(u=n-t.touches[0].clientX,c=o-t.touches[0].clientY)},!1),document.addEventListener("touchend",function(a){if(s!==a.target)return;const i=Date.now()-l;let d="";Math.abs(u)>Math.abs(c)?Math.abs(u)>t&&i<e&&(d=u>0?"swiped-left":"swiped-right"):Math.abs(c)>t&&i<e&&(d=c>0?"swiped-up":"swiped-down"),d&&s.dispatchEvent(new CustomEvent(d,{bubbles:!0,cancelable:!0})),n=null,o=null,l=null},!1)})();
},{}],"Wcnf":[function(require,module,exports) {
(()=>{"use strict";const t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,e=t?"touchstart":"mousedown",n=t?"touchend":"mouseup",o=t?"touchmove":"mousemove",i=10,c=500;let a=null,u=0,s=0;function l(t){return"touches"in t}function d(t){r(t);const e=(new Date).getTime(),o=()=>{var i;(new Date).getTime()-e>=("title"===(null===(i=t.target)||void 0===i?void 0:i.id)?10*c:c)?function(t,e){r(e);const o=l(e)?e.touches[0].clientX:e.clientX,i=l(e)?e.touches[0].clientY:e.clientY;t.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:o,clientY:i}}))&&document.addEventListener(n,e=>{e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),t.dispatchEvent(new CustomEvent("long-press-up",{bubbles:!0,cancelable:!0,detail:{clientX:o,clientY:i}}))},{once:!0,capture:!0})}(t.target,t):a.value=window.requestAnimationFrame(o)};a={value:window.requestAnimationFrame(o)}}function r(t){a&&window.cancelAnimationFrame(a.value),a=null}"function"!=typeof window.CustomEvent&&(window.CustomEvent=((t,e)=>{e=e||{bubbles:!1,cancelable:!1,detail:void 0};const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}),window.CustomEvent.prototype=window.Event.prototype),document.addEventListener(n,r,!0),document.addEventListener(o,function(t){const e=Math.abs(u-(l(t)?t.touches[0].clientX:t.clientX)),n=Math.abs(s-(l(t)?t.touches[0].clientY:t.clientY));(e>=i||n>=i)&&r()},!0),document.addEventListener("wheel",r,!0),document.addEventListener("scroll",r,!0),document.addEventListener(e,function(t){const e=document.getElementById("board");e&&e.contains(t.target)||(u=l(t)?t.touches[0].clientX:t.clientX,s=l(t)?t.touches[0].clientY:t.clientY,d(t))},!0)})();
},{}],"z7jk":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))(function(n,s){function i(e){try{u(o.next(e))}catch(t){s(t)}}function c(e){try{u(o.throw(e))}catch(t){s(t)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,c)}u((o=o.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(e="keyval",t="keyval"){this.storeName=t,this.db=new Promise((r,o)=>{const n=indexedDB.open(e,1);n.onerror=(()=>o(n.error)),n.onsuccess=(()=>r(n.result)),n.onupgradeneeded=(()=>{n.result.createObjectStore(t)})})}static setup(t="keyval",r=["keyval"]){return e(this,void 0,void 0,function*(){return new Promise((e,o)=>{const n=indexedDB.open(t,1);n.onerror=(()=>o(n.error)),n.onsuccess=(()=>e(n.result)),n.onupgradeneeded=(()=>{for(const e of r)n.result.createObjectStore(e)})})})}get(e){let t;return this.withIDBStore("readonly",r=>{t=r.get(e)}).then(()=>t.result)}set(e,t){return this.withIDBStore("readwrite",r=>{r.put(t,e)})}withIDBStore(e,t){return this.db.then(r=>new Promise((o,n)=>{const s=r.transaction(this.storeName,e);s.oncomplete=(()=>o()),s.onabort=s.onerror=(()=>n(s.error)),t(s.objectStore(this.storeName))}))}}exports.Store=t;
},{}],"aKUV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class e{constructor(e,t){this.parent=e,this.children=new Array(26),this.isWord=!1,null!==e&&(e.children[t.charCodeAt(0)-65]=this)}static create(t){const r=new e(null,"");for(const s in t){let n=r;for(let t=0;t<s.length;t++){const r=s[t],c=r.charCodeAt(0);let i=n.children[c-65];void 0===i&&(i=new e(n,r)),n=i}n.isWord=t[s].dict||!0}return r}}exports.Trie=e;
},{}],"qafh":[function(require,module,exports) {

"use strict";function e(e,t){if(!t[e])return"";let n=t[e].defn;if(!n)return"";const r=/[{<](.*?)?=.*?[>}]/g.exec(n);if(r){const e=t[r[1].toUpperCase()];n=e&&e.defn?`${r[1]} (${e.defn})`:r[1]}return n.replace(/\{(.*?)=.*?\}/g,"$1").replace(/<(.*?)=.*?>/g,"$1").replace(/\s*?\[.*?\]\s*?/g,"")}function t(e,t,n){const r=t[e];return r&&(!r.dict||r.dict.includes(n.charAt(0)))}function n(e){const t=[],n=new Set;for(const r of e){const s=r.split("").reverse().join("");if(s!==r&&e.includes(s)){const e=`${[r,s].sort().join(" ")}`;n.has(e)||(n.add(e),t.push(`(${r}`,`${s})`))}else t.push(r)}return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.define=e,exports.isValid=t,exports.order=n;
},{}],"Mkcc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t=4){t=61^t^t>>>16,t+=t<<3,t^=t>>>4,t=Math.imul(t,668265261),t^=t>>>15,this.seed=t>>>0}next(t,e){t&&(t=Math.floor(t)),e&&(e=Math.floor(e));let r=this.seed+=1831565813;r=Math.imul(r^r>>>15,1|r);const o=(r=((r^=r+Math.imul(r^r>>>7,61|r))^r>>>14)>>>0)/Math.pow(2,32);return void 0===t?o:e?Math.floor(o*(e-t))+t:Math.floor(o*t)}shuffle(t){for(let e=t.length-1;e>0;e--){const r=Math.floor(this.next()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}sample(t,e=!1){if(0===t.length)throw new RangeError("Cannot sample an empty array");const r=this.next(t.length),o=t[r];if(e&&(t[r]=t[t.length-1],t.pop()),void 0===o&&!Object.prototype.hasOwnProperty.call(t,r))throw new RangeError("Cannot sample a sparse array");return o}}exports.Random=t;
},{}],"Q9FA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./dict");class s{constructor(t,n){this.dict=n,this.percentiles=t,this.mixed={};for(const o in n){const t=s.toAnagram(o);this.mixed[t]=this.mixed[t]||[],this.mixed[t].push(o)}}anagrams(n,o,r){const e=s.toAnagram(n),i=this.mixed[e],a={words:[]};if(!i)return a;for(const s of i)if(!(r&&s.length<r)&&t.isValid(s,this.dict,o)){a.words.push(s);const t=this.dict[s];for(const s of["n","o","b"])t[s]&&(a[s]=(a[s]||0)+t[s])}return a}stats(s,r="New",e="NWL"){const i=this.dict[s],a=this.anagrams(s,e);if(!t.isValid(s,this.dict,e)||!a.words.length)return{grade:" "};const c=void 0===i.freq?-1:this.percentiles.freqs.findIndex(t=>t<=i.freq),d=-1===c?" ":n(c),h=this.percentiles[r][e],f=r.charAt(0).toLowerCase(),l=i[f]||0,u=h.words.findIndex(t=>t<=l),g=o(u),p=a[f]||0,m=h.anagrams.findIndex(t=>t<=p),w=o(m),x=[" ","A","B","C","D"][Math.ceil((g+w)/2)],A=t=>Math.round(100*t/h.total*1e3)/1e3,M={grade:x<d?d:x};return c>-1&&(M.freq=c),u>-1&&(M.word={p:u,v:A(i.freq)}),m>-1&&(M.anagram={p:m,v:A(p)}),M}history(n,o,r){const e=o.charAt(0).toLowerCase(),i=t=>t.split("").reverse().join(""),a={},c={},d={},h={},f={},l={};let u=n.length;for(const[t,m]of n){const n={};for(const o in t){h[o]=(h[o]||0)+1;const r=s.toAnagram(o);if(n[r]=n[r]||[],n[r].push(o),m.has(o)){l[o]=(l[o]||0)+1;const s=i(o);if(s!==o&&t[s]){const t=[o,s].sort()[0];m.has(s)?o===t&&(f[t]=(f[t]||0)+1):(f[t]=(f[t]||0)+1,c[t]=(c[o]||0)+1/u*this.dict[t][e])}}else a[o]=(a[o]||0)+1/u*this.dict[o][e]}for(const t in n){const s=n[t];if(s.length<=1)continue;const o=s.filter(t=>m.has(t)).length/s.length;if(!o)continue;const r=s.reduce((t,s)=>t+this.dict[s][e],0)/s.length;d[t]=(d[t]||0)+1/u*r*(1-o)}u--}const g=Math.log(n.length);for(const t in h){if(a[t]+=g*this.dict[t][e]*Math.pow(1-(l[t]||0)/h[t],2),c[t]){const s=i(t),[n,o]=(l[s]||0)>(l[t]||0)?[t,s]:[s,t];c[t]+=g*this.dict[t][e]*2*Math.pow(1-(l[n]||0)/(h[o]||1),2)}d[s.toAnagram(t)]&&h[t]&&(d[t]+=g*this.dict[t][e]*Math.pow(1-(l[t]||0)/h[t],2))}const p=(t,s)=>Object.entries(t).sort((t,s)=>s[1]-t[1]).slice(0,s);return{words:p(a,100).map(t=>({w:t[0],found:l[t[0]]||0,all:h[t[0]]||0})),anadromes:p(c,50).map(t=>{const s=t[0],n=i(s),[o,r]=(l[n]||0)>(l[s]||0)?[s,n]:[n,s];return{n:o,fn:l[o]||0,d:r,fd:l[r]||0,e:f[s]||0}}),anagrams:p(d,50).map(s=>{const n=[];for(const o of t.order(this.anagrams(s[0],r).words)){const t=o.replace(/[^A-Z]/,"");n.push({raw:o,found:l[t]||0,all:h[t]||0})}return n})}}static toAnagram(t){return t.split("").sort().join("")}}function n(t){return t>=99?" ":t>=20?"A":t>=10?"B":t>=5?"C":"D"}function o(t){return t>=75?0:t>=50?1:t>=25?2:t>=10?3:4}exports.Stats=s;
},{"./dict":"qafh"}],"dgAm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./dict"),s=require("./random"),e=require("./stats"),i=["AAEEGN","ELRTTY","AOOTTW","ABBJOO","EHRTVW","CIMOTU","DISTTY","EIOSST","DELRVY","ACHOPS","HIMNQU","EEINSU","EEGHNW","AFFKPS","HLNNRZ","DEILRX"],r=["AACIOT","AHMORS","EGKLUY","ABILTY","ACDEMP","EGINTV","GILRUW","ELPSTU","DENOSW","ACELRS","ABJMOQ","EEFHIY","EHINPS","DKNOTU","ADENVZ","BIFORX"],o=["AAAFRS","AAEEEE","AAFIRS","ADENNN","AEEEEM","AEEGMU","AEGMNN","AFIRSY","BJKQXZ","CCNSTW","CEIILT","CEILPT","CEIPST","DDLNOR","DHHLOR","DHHNOT","DHLNOR","EIIITT","EMOTTT","ENSSSU","FIPRSY","GORRVW","HIPRRY","NOOTUW","OOOTTU"];exports.SUFFIXES=["S","ER","ED","ING"];class n{constructor(t,s,e,a,h={dice:"New",dict:"NWL"}){this.trie=t,this.dict=s,this.stats=e,this.dice="Big"===h.dice?o:"Old"===h.dice?r:i,this.size=Math.sqrt(this.dice.length),h.min=h.min||this.size-1,this.settings=h,this.random=a,this.seed=this.random.seed,this.board=[];for(const i of this.dice){const t=this.random.sample(i.split(""));this.board.push("Q"===t?"Qu":t)}this.random.shuffle(this.board),this.possible=this.solve(),this.id=n.encodeID(this.settings,this.seed),this.played={},this.overtime=new Set,this.score={regular:0,overtime:0},this.start=+new Date,this.expired=null}play(t){if(!this.played[t]&&t.length>=this.settings.min){if(this.possible[t]){this.played[t]=+new Date;const s=n.score(t);this.expired&&this.overtime.add(t);const e=this.expired?"overtime":"regular";return this.score[e]+=s,s}this.played[t]=-new Date,this.expired&&this.overtime.add(t)}return 0}toJSON(){return{seed:this.id,start:this.start,expired:this.expired,words:this.played,goal:{S:this.totals.s,A:this.totals.a,B:this.totals.b,C:this.totals.c,D:this.totals.d}}}static encodeID(t,s){return`${t.dice.charAt(0)}${t.min}${t.dict.charAt(0)}${s}`}static decodeID(t){const s=t.charAt(0),e="N"===s?"New":"O"===s?"Old":"B"===s?"Big":void 0;let i=Number(t.charAt(1));(isNaN(i)||i<3||i>5)&&(i=void 0);const r=t.charAt(2),o="N"===r?"NWL":"E"===r?"ENABLE":"C"===r?"CSW":void 0,n=t.slice(3);let a=n.length?Number(n):NaN;return String(a)!==n&&(a=NaN),[{dice:e,min:i,dict:o},a]}static fromJSON(t,e,i,r){const[o,a]=n.decodeID(t.seed),h=new s.Random;h.seed=a;const d=new n(e,i,r,h,o);d.start=t.start,d.expired=t.expired,d.played=t.words;const c={regular:0,overtime:0};for(const s in d.played){if(d.played[s]<0)continue;const t=n.score(s);!d.expired||d.played[s]<=d.expired?c.regular+=t:c.overtime+=t}return d.score=c,d}get totals(){if(this.totals_)return this.totals_;const t={},s={};for(const d in this.possible){const i=e.Stats.toAnagram(d);t[i]=t[i]||[],t[i].push(d);const r=this.stats.stats(d,this.settings.dice,this.settings.dict).grade;s[r]=(s[r]||0)+n.score(d)}const i=s.D||0,r=i+(s.C||0),o=r+(s.B||0),a=o+(s.A||0),h=a+(s[" "]||0);return this.totals_={s:h,a:a,b:o,c:r,d:i,anagrams:t}}progress(){let t=0,s=0,i=0;const r={},o=new Set,h={};for(const n in this.played){if(t++,this.played[n]<0){s++;continue}i++;for(const t of exports.SUFFIXES){let s;s=["ER","ED"].includes(t)&&n.endsWith("E")?`${n}${t.charAt(1)}`:"S"===t&&(n.endsWith("S")||n.endsWith("X"))?`${n}ES`:`${n}${t}`,this.possible[s]&&!this.played[s]&&(r[s]=n)}const d=e.Stats.toAnagram(n);h[d]=h[d]||[],h[d].push(n);for(const t of a(n,this.settings.min))this.possible[t]&&!this.played[t]&&o.add(t)}let d=[];for(const e in h)d=d.concat(this.totals.anagrams[e].filter(t=>!h[e].includes(t)));const c=new Set([...Object.keys(r),...o,...d]);return{invalid:s,valid:i,total:t,score:this.score.regular+this.score.overtime+Array.from(c).reduce((t,s)=>n.score(s)+t,0),suffixes:r,subwords:o.size,anagrams:d.length,missing:c}}state(){const s=this.progress(),i=t=>this.stats.stats(t,this.settings.dice,this.settings.dict).grade,r=s=>({word:s,grade:i(s),defn:t.define(s,this.dict)});return{played:Array.from(Object.entries(this.played)).sort((t,s)=>Math.abs(t[1])-Math.abs(s[1])).map(t=>{const s=t[0],e=r(s);return t[1]<0&&(e.invalid=!0),this.overtime.has(s)&&(e.overtime=!0),e}),remaining:Object.keys(this.possible).filter(t=>!this.played[t]).sort((t,r)=>{const o=s.missing.has(t),n=s.missing.has(r);if(o&&!n)return-1;if(n&&!o)return 1;const a=i(t),h=i(r);return a>h?-1:h>a?1:t.length>r.length?1:r.length>t.length?-1:e.Stats.toAnagram(t).localeCompare(e.Stats.toAnagram(r))}).map(t=>{const e=r(t);return s.missing.has(t)&&(e.missing=!0),s.suffixes[t]&&(e.root=s.suffixes[t]),e}),progress:s,totals:this.totals}}solve(){const t={},s=[];for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++){let i=this.board[this.size*e+t];const r=i.charCodeAt(0);let o=this.trie.children[r-65];"Qu"===i&&void 0!==o&&(i="QU",o=o.children[20]),void 0!==o&&s.push([t,e,i,o,[[t,e]]])}for(;0!==s.length;){const[e,i,r,o,n]=s.pop();for(const[a,h]of[[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1]]){const[d,c]=[e+a,i+h];if(void 0===n.find(t=>t[0]===d&&t[1]===c)&&(0<=d&&d<this.size&&0<=c&&c<this.size)){const e=n.slice();e.push([d,c]);let i=this.board[this.size*c+d],a=o.children[i.charCodeAt(0)-65];if("Qu"===i&&void 0!==a&&(i="QU",a=a.children[20]),void 0!==a){const o=r+i;("boolean"==typeof a.isWord?a.isWord:a.isWord.includes(this.settings.dict.charAt(0)))&&o.length>=this.settings.min&&(t[o]=e),s.push([d,c,o,a,e])}}}}return t}static score(t){return t.length<3?0:t.length<=4?1:5===t.length?2:6===t.length?3:7===t.length?5:11}}function a(t,s){const e=new Set;for(let i=0;i<t.length;i++)for(let r=1;r<=t.length-i;r++){const o=t.substr(i,r);o.length>=s&&e.add(o)}return e}exports.Game=n;
},{"./dict":"qafh","./random":"Mkcc","./stats":"Q9FA"}],"VlPw":[function(require,module,exports) {
"use strict";var o=this&&this.__awaiter||function(o,e,t,l){return new(t||(t=Promise))(function(r,s){function a(o){try{n(l.next(o))}catch(e){s(e)}}function i(o){try{n(l.throw(o))}catch(e){s(e)}}function n(o){var e;o.done?r(o.value):(e=o.value,e instanceof t?e:new t(function(o){o(e)})).then(a,i)}n((l=l.apply(o,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../store"),t=require("../trie"),l=require("../game"),r=require("../stats"),s=new e.Store("db","store"),a={dice:"New",min:3,dict:"NWL",grade:"C",display:"Show"},i=o=>fetch(o,{mode:"no-cors"}).then(o=>o.json());exports.global={SETTINGS:JSON.parse(localStorage.getItem("settings"))||a,STORE:s,LIMIT:500,MAX_SEED:1e12,DICT:void 0,STATS:void 0,HISTORY:void 0,TRIE:void 0,GAMES:void 0,PLAYED:void 0,SEED:0,LOADED:{DICT:i("data/dict.json").then(o=>{exports.global.DICT=o}),TRIE:()=>o(void 0,void 0,void 0,function*(){exports.global.TRIE||(yield exports.global.LOADED.DICT,exports.global.TRIE=t.Trie.create(exports.global.DICT))}),STATS:()=>o(void 0,void 0,void 0,function*(){if(exports.global.STATS)return;let o;yield Promise.all([exports.global.LOADED.DICT,i("data/stats.json").then(e=>{o=e})]),exports.global.STATS=new r.Stats(o,exports.global.DICT)}),HISTORY:s.get("history").then(o=>{exports.global.HISTORY=o||[]}),TRAINING:e.Store.setup("training",["NWL","ENABLE","CSW"]),GAMES:()=>o(void 0,void 0,void 0,function*(){if(!exports.global.GAMES){yield Promise.all([exports.global.LOADED.HISTORY,exports.global.LOADED.TRIE(),exports.global.LOADED.DICT,exports.global.LOADED.STATS()]),exports.global.GAMES=[];for(let o=exports.global.HISTORY.length-1;o>=0&&exports.global.GAMES.length<exports.global.LIMIT;o--){const e=l.Game.fromJSON(exports.global.HISTORY[o],exports.global.TRIE,exports.global.DICT,exports.global.STATS),t=new Set;for(const o in e.played)e.played[o]>0&&t.add(o);exports.global.GAMES.push([e.possible,t])}}}),PLAYED:()=>o(void 0,void 0,void 0,function*(){if(!exports.global.PLAYED){yield exports.global.LOADED.HISTORY,exports.global.PLAYED=new Set;for(const o of exports.global.HISTORY)exports.global.PLAYED.add(o.seed)}})}};
},{"../store":"z7jk","../trie":"aKUV","../game":"dgAm","../stats":"Q9FA"}],"xNB3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class t{constructor(t,e,s=0,i=null,a=null){this.duration=e,this.display=t,this.elapsed=s,this.interval=null,this.expireFn=i,this.updateFn=a,this.render()}toJSON(){return{duration:this.duration,elapsed:this.elapsed}}start(){this.interval||(this.begin=(new Date).getTime(),this.last=this.begin,this.interval=setInterval(()=>this.update(),100))}stop(){this.interval&&(clearInterval(this.interval),this.interval=null,this.begin=(new Date).getTime(),this.elapsed+=this.begin-this.last,this.last=this.begin)}toggle(){this.interval?this.stop():this.start()}expired(){return this.elapsed>=this.duration}update(){const t=(new Date).getTime();this.elapsed+=t-this.last,this.last=t;const e=this.display.textContent;this.render(),e!==this.display.textContent&&this.updateFn&&this.updateFn()}render(){let t;this.expired()?(this.display.classList.add("expired"),t=this.elapsed-this.duration,this.expireFn&&(this.expireFn(),this.expireFn=null)):(this.display.classList.remove("expired"),t=this.duration-this.elapsed);const e=Math.floor(t%36e5/6e4),s=`${Math.floor(t%6e4/1e3)}`.padStart(2,"0");this.display.textContent=`${e}:${s}`}}exports.Timer=t;
},{}],"mx3t":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))(function(a,o){function n(t){try{d(i.next(t))}catch(e){o(e)}}function r(t){try{d(i.throw(t))}catch(e){o(e)}}function d(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(n,r)}d((i=i.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./global"),s=require("./ui"),i=require("../game"),a=require("../timer"),o=require("../random"),n=require("../dict"),r=18e4,d=t=>t.split("").every(t=>t>="A"&&t<="Z"||t>="a"&&t<="z");class l{constructor(t){this.last=t?t.last:"",this.kept=!!t&&t.kept,this.game=t?t.game:void 0,this.paused=!!t&&t.paused;const{display:e,timer:s}=this.createTimer(t&&t.timer);this.timer=s,this.timerDisplay=e,document.addEventListener("visibilitychange",t=>{document.hidden?this.timer.stop():this.paused||this.timer.start()})}toJSON(){return{last:this.last,kept:this.kept,paused:this.paused,timer:this.timer.toJSON(),game:this.game&&("random"in this.game?this.game.toJSON():this.game)}}init(a={}){return t(this,void 0,void 0,function*(){if(yield Promise.all([e.global.LOADED.DICT,e.global.LOADED.TRIE(),e.global.LOADED.STATS(),e.global.LOADED.HISTORY,e.global.LOADED.PLAYED()]),!this.game||a.new){let t,s=e.global.SEED;this.game&&(this.timer.stop(),"random"in this.game||(this.game=i.Game.fromJSON(this.game,e.global.TRIE,e.global.DICT,e.global.STATS)),this.game.seed===s&&(s=this.game.random.seed%e.global.MAX_SEED),e.global.PLAYED.add(this.game.id),Object.values(this.game.played).filter(t=>t>0).length&&(this.updateGames(),e.global.HISTORY.push(this.game.toJSON()),yield e.global.STORE.set("history",e.global.HISTORY)));const n=new o.Random;for(;!t||!Object.keys(t.possible).length;){n.seed=s;const o=i.Game.encodeID(e.global.SETTINGS,n.seed);!e.global.PLAYED.has(o)||a.allowDupes?t=new i.Game(e.global.TRIE,e.global.DICT,e.global.STATS,n,e.global.SETTINGS):s=(s+1)%e.global.MAX_SEED}this.game=t,e.global.SEED=s;const{display:r,timer:d}=this.createTimer();this.timer=d,this.timerDisplay=r,this.last="",this.kept=!1,this.paused=!1}else"random"in this.game||(this.game=i.Game.fromJSON(this.game,e.global.TRIE,e.global.DICT,e.global.STATS));const t=`#${this.game.id}`;document.location.hash!==t&&window.history.replaceState(null,"",t),this.full||(this.full=s.UI.createElementWithId("div","full")),this.score||(this.score=s.UI.createElementWithId("div","score"),this.displayScore())})}attach(e={}){return t(this,void 0,void 0,function*(){yield this.init(e),this.container=s.UI.createElementWithId("div","game");const t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,i=s.UI.createBackButton(()=>s.UI.toggleView("Menu"));i.addEventListener("long-press",e=>(t&&e.preventDefault(),this.refresh({new:!0})));const a=s.UI.createElementWithId("div","score-wrapper");return a.appendChild(this.score),a.addEventListener("mouseup",()=>s.UI.toggleView("Score")),a.addEventListener("long-press",()=>this.onLongPress()),a.addEventListener("long-press-up",()=>this.onLongPressUp()),this.container.appendChild(s.UI.createTopbar(i,this.timerDisplay,a)),this.container.appendChild(this.full),this.container.appendChild(this.renderBoard()),this.displayScore(),this.word=s.UI.createElementWithId("div","word"),this.word.classList.add("word"),this.word.addEventListener("beforeinput",t=>this.onBeforeInput(t)),t||(this.word.contentEditable="true"),this.container.appendChild(this.word),this.defn=s.UI.createElementWithId("div","defn"),this.defn.classList.add("definition"),this.container.appendChild(this.defn),this.paused||this.timer.start(),this.container})}renderBoard(){const t=this.game,e=s.UI.createElementWithId("div","board-wrapper"),i=s.UI.createElementWithId("table","board");t.size>4&&i.classList.add("big"),this.tds=new Set;const a=new o.Random(t.seed);for(let s=0;s<t.size;s++){const e=document.createElement("tr");for(let i=0;i<t.size;i++){const o=document.createElement("td"),n=document.createElement("div");n.textContent=t.board[s*t.size+i],"Qu"===n.textContent&&n.classList.add("qu"),["M","W","Z"].includes(n.textContent)&&n.classList.add("underline"),n.classList.add(`rotate${90*a.next(0,4)}`),o.setAttribute("data-x",String(s)),o.setAttribute("data-y",String(i)),o.appendChild(n);const r=document.createElement("div");r.classList.add("target"),r.setAttribute("data-x",String(s)),r.setAttribute("data-y",String(i)),o.appendChild(r),e.appendChild(o),this.tds.add(o)}i.appendChild(e)}let n=new Set;const r=()=>{for(const t of n)t.classList.remove("selected")},d=t=>{const e=t.touches[0],s=document.elementFromPoint(e.clientX,e.clientY);if(s&&s.matches(".target")){const t=s.parentNode;t.classList.add("selected"),n.has(t)||(n.add(t),this.word.textContent+=t.textContent)}};return i.addEventListener("touchstart",t=>{this.clear(),r(),n=new Set,d(t)}),i.addEventListener("touchend",()=>{r(),this.play()}),i.addEventListener("touchmove",d),e.appendChild(i),e}afterAttach(){s.UI.permaFocus(this.word)}detach(t){return["Score","Define"].includes(t)||this.timer.stop(),this.container}refresh(e={}){return t(this,void 0,void 0,function*(){s.UI.persist(),yield s.UI.detachView("Board","Board"),yield s.UI.attachView("Board",e)})}play(){const t=this.game;let a=(this.word.textContent||"").toUpperCase();if(!a.length)return;(a.length<3||i.SUFFIXES.includes(a))&&(a=`${this.last}${a}`,this.word.textContent=a);const o=t.play(a);this.last=a,s.UI.persist();const r="Hide"===e.global.SETTINGS.display;if(this.kept=!0,!r&&o)this.displayScore(),this.defn.textContent=n.define(a,e.global.DICT);else{const e=this.word.textContent||void 0;!r&&t.played[a]<0&&this.word.classList.add("error"),this.word.classList.add("fade"),this.word.addEventListener("animationend",()=>this.clear(e),{once:!0})}}displayScore(){const t=this.game;if("Hide"===e.global.SETTINGS.display)return this.score.textContent="?",void this.full.classList.add("hidden");if("Full"===e.global.SETTINGS.display){const s=t.state(),i=s.progress,a=`(${i.score}) ${Object.keys(i.suffixes).length}/${i.subwords}/${i.anagrams}`,o=t.score.regular+t.score.overtime,n=s.totals[e.global.SETTINGS.grade.toLowerCase()],r=Math.round(o/n*100).toFixed(0);this.full.classList.remove("hidden"),this.full.textContent=`${a} - ${o}/${n} (${r}%)`}else this.full.classList.add("hidden");const s=t.score;this.score.textContent=s.overtime?`${s.regular} / ${s.overtime}`:`${s.regular}`}clear(t){t&&t!==this.word.textContent||(this.word.textContent="",this.word.classList.remove("error"),this.word.classList.remove("fade"),this.defn.textContent="",this.kept=!1)}createTimer(t){const e=s.UI.createElementWithId("div","timer");e.addEventListener("click",()=>{this.timer.toggle(),this.paused=!this.paused});const i=t?t.duration:r,o=t?t.elapsed:0;return{display:e,timer:new a.Timer(e,i,o,()=>{this.game&&!this.game.expired&&(this.game.expired=+new Date)},()=>s.UI.persist())}}updateGames(){if(!e.global.GAMES)return;const t=this.game,s=new Set;for(const e in t.played)t.played[e]>0&&s.add(e);s.size&&(e.global.GAMES.length>=e.global.LIMIT&&e.global.GAMES.shift(),e.global.GAMES.push([t.possible,s]))}onLongPress(){const t=this.game,e=t.size,s=[];for(let i=0;i<e;i++){const t=[];for(let s=0;s<e;s++)t.push(0);s.push(t)}let a=0;for(const o in t.possible){if(t.played[o])continue;const e=i.Game.score(o);a+=e;for(const i of t.possible[o])s[i[1]][i[0]]+=e}for(const i of this.tds){const t=s[Number(i.dataset.x)][Number(i.dataset.y)]/a;i.style.backgroundColor=`rgba(255,0,0,${t})`}}onLongPressUp(){for(const t of this.tds)t.style.removeProperty("background-color")}onBeforeInput(e){return t(this,void 0,void 0,function*(){if(e.inputType.startsWith("delete")||e.data&&d(e.data))return;e.preventDefault(),(["insertLineBreak","insertParagraph"].includes(e.inputType)||e.data&&e.data.includes(" "))&&(this.play(),s.UI.focusContentEditable(this.word))})}onKeyDown(e){return t(this,void 0,void 0,function*(){if(!this.word)return;this.kept&&this.clear(),s.UI.focusContentEditable(this.word);const t=e.keyCode;13===t||32===t?(e.preventDefault(),this.play(),s.UI.focusContentEditable(this.word)):[0,37,39,8,46].includes(t)||d(String.fromCharCode(t))||e.preventDefault()})}}exports.BoardView=l;
},{"./global":"VlPw","./ui":"ePHQ","../game":"dgAm","../timer":"xNB3","../random":"Mkcc","../dict":"qafh"}],"LEQV":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))(function(l,n){function d(e){try{o(s.next(e))}catch(t){n(t)}}function i(e){try{o(s.throw(e))}catch(t){n(t)}}function o(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(d,i)}o((s=s.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./global"),a=require("./ui"),s=require("../game");class l{constructor(e){this.board=e}toJSON(){}attach(){return e(this,void 0,void 0,function*(){yield this.board.init(),this.container=a.UI.createElementWithId("div","game");const e=a.UI.createElementWithId("div","score-history"),l=a.UI.createBackButton(()=>a.UI.toggleView("Board"));this.container.appendChild(a.UI.createTopbar(l,this.board.timerDisplay,this.board.score));const d=this.board.game,i=d.state(),o=d.score.regular+d.score.overtime,c=i.totals[t.global.SETTINGS.grade.toLowerCase()],r=`${o}/${c} (${Math.round(o/c*100).toFixed(0)}%)`,p=n(d.id,r,"block"),h=document.createElement("div");h.classList.add("collapsible-content"),this.displayPlayed(i,h,!0),this.displayPossible(i,h),e.appendChild(p),e.appendChild(h),p.classList.add("active"),h.style.display="block";for(let a=t.global.HISTORY.length-1;a>=0;a--){const l=t.global.HISTORY[a];let d=0;for(const[e,t]of Object.entries(l.words))t>0&&(d+=s.Game.score(e));if(!d)continue;const i=`${d}/${l.goal[t.global.SETTINGS.grade]} (${Math.round(d/l.goal[t.global.SETTINGS.grade]*100).toFixed(0)}%)`,o=document.createElement("div");o.classList.add("collapsible-content"),o.classList.add("lazy");const c=n(l.seed,i,"block",()=>{if(o.classList.contains("lazy")){o.classList.remove("lazy");const e=s.Game.fromJSON(l,t.global.TRIE,t.global.DICT,t.global.STATS).state();this.displayPlayed(e,o),this.displayPossible(e,o)}});e.appendChild(c),e.appendChild(o)}return this.container.appendChild(e),this.container})}detach(){return this.container}displayPlayed(e,a,s=!1){const l=e.progress,d=n("PLAYED",`(${l.score}) ${Object.keys(l.suffixes).length}/${l.subwords}/${l.anagrams} (${l.invalid}/${l.total})`,"table"),i=document.createElement("table");i.classList.add("collapsible-content"),i.classList.add("results"),i.classList.add("played");for(const{word:n,grade:o,overtime:c,defn:r,invalid:p}of e.played){const e=document.createElement("tr");o<t.global.SETTINGS.grade&&e.classList.add("hard"),p&&e.classList.add("error"),c&&e.classList.add("overtime");let a=document.createElement("td");const s=document.createElement("b");s.textContent=n,a.appendChild(s),e.appendChild(a),a=document.createElement("td"),r&&(a.textContent=r),e.appendChild(a),i.appendChild(e)}s&&(d.classList.add("active"),i.style.display="table"),a.appendChild(d),a.appendChild(i)}displayPossible(e,a,s=!1){const l=e.totals,d=n("POSSIBLE",`${l.d}/${l.c}/${l.b}/${l.a} (${l.s})`,"table"),i=document.createElement("table");i.classList.add("collapsible-content"),i.classList.add("results"),i.classList.add("possible");for(const{word:n,grade:o,root:c,missing:r,defn:p}of e.remaining){const e=document.createElement("tr");o<t.global.SETTINGS.grade&&e.classList.add("hard");let a=document.createElement("td");const s=document.createElement("b");if(c){const e=document.createElement("span");e.textContent=c;const t=document.createElement("span");t.classList.add("underline"),t.textContent=n.slice(c.length),s.appendChild(e),s.appendChild(t)}else r&&s.classList.add("underline"),s.textContent=n;a.appendChild(s),e.appendChild(a),(a=document.createElement("td")).textContent=p,e.appendChild(a),i.appendChild(e)}s&&(d.classList.add("active"),i.style.display="table"),a.appendChild(d),a.appendChild(i)}}function n(e,t,a,s){const l=document.createElement("button");l.setAttribute("type","button"),l.classList.add("collapsible");const n=document.createElement("div"),d=document.createElement("span");d.classList.add("collapsible-title"),d.textContent=e;const i=document.createElement("span");return i.classList.add("collapsible-details"),i.textContent=t,n.appendChild(d),n.appendChild(i),l.appendChild(n),l.addEventListener("click",()=>{l.classList.toggle("active");const e=l.nextElementSibling;e.style.display===a?e.style.display="none":(s&&s(),e.style.display=a)}),l}exports.ScoreView=l;
},{"./global":"VlPw","./ui":"ePHQ","../game":"dgAm"}],"GDz3":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,d){function a(e){try{o(i.next(e))}catch(t){d(t)}}function r(e){try{o(i.throw(e))}catch(t){d(t)}}function o(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,r)}o((i=i.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./global"),n=require("./ui"),i=require("../dict"),s=e=>e.split("").every(e=>e>="A"&&e<="Z"||e>="a"&&e<="z");class d{constructor(e){this.defn=null,this.stats=null,this.anagrams=null,this.word=e?e.word:""}toJSON(){return{word:this.word}}attach(i){return e(this,void 0,void 0,function*(){return yield Promise.all([t.global.LOADED.DICT,t.global.LOADED.STATS()]),i&&(this.word=i),this.define=n.UI.createElementWithId("div","define"),this.search=n.UI.createElementWithId("div","search"),this.search.classList.add("word"),this.search.contentEditable="true",this.search.textContent=this.word,this.search.addEventListener("beforeinput",e=>this.onBeforeInput(e)),this.search.addEventListener("input",()=>{const e=this.search.textContent;this.query(e&&s(e)?e:"")}),this.define.appendChild(this.search),this.update(),this.define})}afterAttach(){n.UI.permaFocus(this.search)}query(e){this.search.textContent=e,n.UI.focusContentEditable(this.search),this.word=e.toUpperCase(),this.update(),n.UI.persist()}detach(){return this.defn=null,this.stats=null,this.anagrams=null,this.define}update(){const e=t.global.DICT[this.word];if(e){const s=n.UI.createElementWithId("div","defineDefn");s.classList.add("definition"),s.textContent=i.define(this.word,t.global.DICT),e.dict&&!e.dict.includes(t.global.SETTINGS.dict.charAt(0))||this.word.length<t.global.SETTINGS.min?this.define.classList.add("hard"):this.define.classList.remove("hard");const d=(e,t,n)=>{let i=document.createElement("td");const s=document.createElement("b");s.textContent=t,i.appendChild(s),e.appendChild(i),(i=document.createElement("td")).classList.add("value"),i.textContent=n,e.appendChild(i)},a=t.global.STATS.stats(this.word,t.global.SETTINGS.dice,t.global.SETTINGS.dict),r=document.createElement("table");r.classList.add("roundedTable");let o=document.createElement("tr");d(o,"Grade"," "===a.grade?"S":a.grade),d(o,"Score",a.word?String(a.word.p):"-"),r.appendChild(o),d(o=document.createElement("tr"),"Frequency",a.freq?String(a.freq):"-"),d(o,"Anagram",a.anagram?String(a.anagram.p):"-"),r.appendChild(o),r.appendChild(o),this.defn&&this.define.removeChild(this.defn),this.define.appendChild(s),this.defn=s,this.stats&&this.define.removeChild(this.stats),this.define.appendChild(r),this.stats=r}else this.defn&&(this.define.removeChild(this.defn),this.defn=null),this.stats&&(this.define.removeChild(this.stats),this.stats=null);const s=this.renderAnagrams();this.anagrams&&this.define.removeChild(this.anagrams),this.define.appendChild(s),this.anagrams=s}renderAnagrams(){const e=n.UI.createElementWithId("div","defineAnagrams"),i=t.global.STATS.anagrams(this.word,t.global.SETTINGS.dict).words;if(i.length<=1)return e;const s=[],d=new Set;for(const t of i){const e=t.split("").reverse().join("");e!==t&&i.includes(e)?d.add(`${[t,e].sort().join(" ")}`):s.push(t)}const a=e=>{const t=document.createElement(e===this.word?"b":"span");return t.textContent=e,t.addEventListener("click",()=>this.query(e)),t};for(const t of d){const[n,i]=t.split(" ");e.appendChild(document.createTextNode(" (")),e.appendChild(a(n)),e.appendChild(document.createTextNode(" ")),e.appendChild(a(i)),e.appendChild(document.createTextNode(") "))}for(const t of s)e.appendChild(a(t)),e.appendChild(document.createTextNode(" "));return e}onBeforeInput(t){return e(this,void 0,void 0,function*(){if(t.inputType.startsWith("delete")||t.data&&s(t.data))return;t.preventDefault(),(["insertLineBreak","insertParagraph"].includes(t.inputType)||t.data&&t.data.includes(" "))&&(this.word?this.query(""):yield n.UI.toggleView("Define"))})}onKeyDown(t){return e(this,void 0,void 0,function*(){if(!this.search)return;n.UI.focusContentEditable(this.search);const e=t.keyCode;13===e||32===e?(t.preventDefault(),this.word?this.query(""):yield n.UI.toggleView("Define")):27===e?yield n.UI.toggleView("Define"):[0,37,39,8,46].includes(e)||s(String.fromCharCode(e))||t.preventDefault()})}}exports.DefineView=d;
},{"./global":"VlPw","./ui":"ePHQ","../dict":"qafh"}],"qI3H":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(d,a){function o(e){try{l(i.next(e))}catch(t){a(t)}}function c(e){try{l(i.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?d(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((i=i.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./ui");class n{toJSON(){}attach(){this.menu=t.UI.createElementWithId("div","men");const n=t.UI.createElementWithId("h1","title");n.textContent="BOGGLE",n.addEventListener("long-press",()=>e(this,void 0,void 0,function*(){const e=(yield caches.keys()).find(e=>e.includes(":cache:"));e&&(yield caches.delete(e)),document.location.reload(!0)})),this.menu.appendChild(n);const i=document.createElement("nav"),d=(e,t)=>{const n=document.createElement("button");return n.classList.add("toggle"),n.textContent=e,n.addEventListener("click",t),n};return t.UI.Views.Board.game?(i.appendChild(d("RESUME",()=>t.UI.toggleView("Board"))),i.appendChild(d("NEW GAME",()=>t.UI.toggleView("Board",{new:!0})))):i.appendChild(d("PLAY",()=>t.UI.toggleView("Board"))),i.appendChild(d("TRAIN",()=>t.UI.toggleView("Training"))),i.appendChild(d("DEFINE",()=>t.UI.toggleView("Define"))),i.appendChild(d("STATS",()=>t.UI.toggleView("Stats"))),i.appendChild(d("SETTINGS",()=>t.UI.toggleView("Settings"))),this.menu.appendChild(i),this.menu}detach(){return this.menu}}exports.MenuView=n;
},{"./ui":"ePHQ"}],"AOXD":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))(function(n,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function l(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,l)}s((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./global"),i=require("./ui"),r=require("../dict"),n=require("../store");class a{constructor(e){this.training=e}toJSON(){}attach(){return e(this,void 0,void 0,function*(){yield this.training.init(),this.review=i.UI.createElementWithId("div","review");const e=i.UI.createBackButton(()=>i.UI.toggleView("Training"));this.review.appendChild(i.UI.createTopbar(e,null,this.training.progress));const a=t.global.SETTINGS.dice.charAt(0).toLowerCase(),o=e=>t.global.STATS.anagrams(e,t.global.SETTINGS.dict)[a]||0,l=new n.Store("training",t.global.SETTINGS.dict),s=((yield l.get("data"))||[]).filter(e=>!e.c||e.e<2).sort((e,t)=>o(t.k)/t.e-o(e.k)/e.e).map(e=>e.k),c=i.UI.createElementWithId("div","review-results-wrapper");if(s.length)for(const n of s){const e=i.UI.createElementWithId("table","review-results");i.UI.addAnagramRows(e,r.order(t.global.STATS.anagrams(n,t.global.SETTINGS.dict).words)),c.appendChild(e)}else c.appendChild(i.UI.createPlaceholder());return this.review.appendChild(c),this.review})}detach(){return this.review}}exports.ReviewView=a;
},{"./global":"VlPw","./ui":"ePHQ","../dict":"qafh","../store":"z7jk"}],"UoCm":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,d){function a(e){try{l(n.next(e))}catch(t){d(t)}}function o(e){try{l(n.throw(e))}catch(t){d(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./global"),i=require("./ui"),n=require("../game"),s=new Set(["B","b","N","n","E","e","C","c","O","o","0","1","2","3","4","5","6","7","8","9"]),d=e=>e.split("").every(e=>s.has(e));class a{toJSON(){}attach(){this.settings=i.UI.createElementWithId("div","settings"),this.seed=i.UI.createElementWithId("div","seed"),this.seed.textContent=n.Game.encodeID(t.global.SETTINGS,t.global.SEED),this.seed.setAttribute("contenteditable","true"),this.seed.addEventListener("input",()=>this.onInput(this.seed.textContent||"")),this.seed.addEventListener("beforeinput",e=>this.onBeforeInput(e));const e=i.UI.createBackButton(()=>i.UI.toggleView("Menu"));this.settings.appendChild(i.UI.createTopbar(e,this.seed,null));const s=(e,n,s,d)=>{const a=document.createElement("div");a.classList.add("row");const o=i.UI.createRadios(d||e,n.map(i=>i===String(t.global.SETTINGS[e])?[i]:i),s);return a.appendChild(o),a};return this.settings.appendChild(s("dice",["New","Old","Big"],function(){const e="Big"===this.value?4:3;document.getElementById(`min${e}`).checked=!0,i.UI.updateSettings({dice:this.value,min:e})})),this.settings.appendChild(s("min",["3","4","5"],function(){i.UI.updateSettings({min:Number(this.value)})})),this.settings.appendChild(s("dict",["NWL","ENABLE","CSW"],function(){i.UI.updateSettings({dict:this.value})})),this.settings.appendChild(s("grade",["A","B","C","D"],function(){i.UI.updateSettings({grade:this.value})})),this.settings.appendChild(s("display",["Hide","Show","Full"],function(){i.UI.updateSettings({display:this.value})},"scoreDisplay")),this.settings.appendChild(s("theme",["Light","Dark"],function(){const e=this.value;i.UI.updateSettings({theme:e}),i.UI.setTheme(e)})),this.settings}detach(){return this.settings}update(){this.seed.textContent=n.Game.encodeID(t.global.SETTINGS,t.global.SEED),this.seed.classList.remove("error");const e=e=>document.getElementById(e).checked=!0;e(`dice${t.global.SETTINGS.dice}`),e(`min${t.global.SETTINGS.min}`),e(`dict${t.global.SETTINGS.dict}`),e(`grade${t.global.SETTINGS.grade}`),e(`scoreDisplay${t.global.SETTINGS.display}`),e(`theme${t.global.SETTINGS.theme||"Light"}`)}onInput(e){if(!d(e))return;const[t,s]=n.Game.decodeID(e);i.UI.valid(t,s)?(i.UI.updateSettings(t,s,!1),this.update(),i.UI.focusContentEditable(this.seed)):this.seed.classList.add("error")}onBeforeInput(e){e.inputType.startsWith("delete")||e.data&&d(e.data)||e.preventDefault()}onKeyDown(t){return e(this,void 0,void 0,function*(){if(!this.seed)return;const e=t.keyCode;[0,37,39,8,46].includes(e)||d(String.fromCharCode(e))||t.preventDefault()})}}exports.SettingsView=a;
},{"./global":"VlPw","./ui":"ePHQ","../game":"dgAm"}],"PRMN":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,n,s){return new(n||(n=Promise))(function(a,l){function o(t){try{i(s.next(t))}catch(e){l(e)}}function c(t){try{i(s.throw(t))}catch(e){l(e)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,c)}i((s=s.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./global"),n=require("./ui");class s{constructor(t){this.table=null,this.section=t?t.section:"WORD"}toJSON(){return{section:this.section}}attach(){return t(this,void 0,void 0,function*(){yield e.global.LOADED.GAMES();const t=e.global.STATS.history(e.global.GAMES,e.global.SETTINGS.dice,e.global.SETTINGS.dict);this.stats=n.UI.createElementWithId("div","stats");const s=n.UI.createBackButton(()=>n.UI.toggleView("Menu")),a=e=>this.display(e,t),l=n.UI.createRadios("statsSelect",["WORD","ANAGRAM","PAIR"].map(t=>t===this.section?[t]:t),function(){a(this.value),n.UI.persist()});return this.stats.appendChild(n.UI.createTopbar(s,l,null)),this.display(this.section,t),this.stats})}detach(){return this.table=null,this.stats}display(t,e){this.section=t;const{words:s,anadromes:a,anagrams:l}=e,o=t=>{const e=document.createElement("b");return e.textContent=t,e.addEventListener("click",()=>n.UI.toggleView("Define",t)),e};let c=document.createElement("table");if(c.classList.add("roundedTable"),"PAIR"===t)if(a.length)for(const{n:n,fn:i,d:d,fd:r,e:h}of a){const t=document.createElement("tr");let e=document.createElement("td");e.appendChild(o(n)),t.appendChild(e),(e=document.createElement("td")).textContent=`${i}/${r} (${h})`,t.appendChild(e),(e=document.createElement("td")).appendChild(o(d)),t.appendChild(e),c.appendChild(t)}else c=n.UI.createPlaceholder();else if("WORD"===t)if(s.length)for(const{w:n,found:i,all:d}of s){const t=document.createElement("tr");let e=document.createElement("td");e.appendChild(o(n)),t.appendChild(e),(e=document.createElement("td")).textContent=`${i}/${d}`,t.appendChild(e),c.appendChild(t)}else c=n.UI.createPlaceholder();else if(l.length)for(const n of l){const t=document.createElement("tr"),e=document.createElement("td");let s=[],a=!1;for(const{raw:l,found:c,all:i}of n){const t=l.replace(/[^A-Z]/,"");if(l.startsWith("(")){const t=document.createElement("b");t.textContent="(",s.push(t),a=!0}s.push(o(t));const n=document.createElement("span");if(n.textContent=` ${c}/${i}`,l.endsWith(")")){s.push(n);const t=document.createElement("b");t.textContent=")",s.push(t),a=!1}else a&&(n.textContent+=" "),s.push(n);if(!a){for(const t of s)e.appendChild(t);e.appendChild(document.createElement("br")),s=[]}}t.appendChild(e),c.appendChild(t)}else c=n.UI.createPlaceholder();this.table&&this.stats.removeChild(this.table),this.stats.appendChild(c),this.table=c}}exports.StatsView=s;
},{"./global":"VlPw","./ui":"ePHQ"}],"l4Rm":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))(function(a,i){function h(t){try{o(n.next(t))}catch(e){i(e)}}function r(t){try{o(n.throw(t))}catch(e){i(e)}}function o(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s(function(t){t(e)})).then(h,r)}o((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./dict"),s=require("./random"),n=3,a=864e5;function i(t,e){return t<e?-1:t>e?1:0}class h{constructor(t=[],e=i){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this.down(s)}push(t){this.data.push(t),this.length++,this.up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this.down(0)),t}peek(){return this.data[0]}up(t){const e=this.data[t];for(;t>0;){const s=t-1>>1,n=this.data[s];if(this.compare(e,n)>=0)break;this.data[t]=n,t=s}this.data[t]=e}down(t){const e=this.length>>1,s=this.data[t];for(;t<e;){let e=1+(t<<1),n=this.data[e];const a=e+1;if(a<this.length&&this.compare(this.data[a],n)<0&&(e=a,n=this.data[a]),this.compare(n,s)>=0)break;this.data[t]=n,t=e}this.data[t]=s}}class r{constructor(t,e,s,n,a,i){this.unlearned=t,this.learned=e,this.size=e.length,this.d=s,this.type=n,this.store=a,this.stats=i}static create(e,s,n,a,i){return t(this,void 0,void 0,function*(){const t=s.toLowerCase()[0],o=new h([],(t,e)=>t.d-e.d),d=new Set,l=yield a.get("data");if(l){o.data=l,o.length=l.length;for(const t of l)d.add(t.k)}const c=[];for(const s in e.mixed)if(!d.has(s)){const a=e.anagrams(s,n,i)[t]||0;a&&c.push({k:s,w:a})}c.sort((t,e)=>t.w-e.w);const u=c.map(t=>t.k);return new r(u,o,t,n,a,e)})}overdue(){const t=+new Date,e=[];let s=this.size===this.learned.length?0:1;for(let n=this.learned.pop();n&&(e.push(n),!(n.d>t));n=this.learned.pop())s++;for(const n of e)this.learned.push(n);return s}next(){const t=+new Date,n=()=>{if(this.unlearned.length)return{k:this.unlearned.pop(),e:2.5,c:0,n:0,d:0,p:0}};let a=this.learned.pop();if(a){if(a.d>t){const t=n();t&&(this.learned.push(a),a=t)}}else a=n();if(!a)throw new RangeError;let i=a.k;const h=this.stats.anagrams(i,this.type).words,r=()=>{this.learned.push(a),this.size=this.learned.length},d=new s.Random(a.n);for(let e=0;e<10&&(i=d.shuffle(i.split("")).join(""),h.includes(i));e++);return{label:i,group:e.order(h),update:e=>(a=o(a,e,t),r(),this.store.set("data",this.learned.data)),restore:r}}}function o(t,e,s){let i=.28*e-.8-.02*e*e;i<0&&(i*=Math.min(2.5*Math.pow(2,t.n+1),100)/100);if(e>=3){const e=t.d?Math.min(2,(t.d-t.p)/a/(t.c?n:1)):1;t.c++,t.e=Math.max(1.3,t.e+i*e),t.d=s+a*n*Math.pow(t.e,t.c-1)*e}else t.c=0,t.e=Math.max(1.3,t.e+i),t.d=s+a;return t.n++,t.p=s,t}exports.TrainingPool=r;
},{"./dict":"qafh","./random":"Mkcc"}],"vUQU":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(s,r){function o(t){try{l(n.next(t))}catch(e){r(e)}}function d(t){try{l(n.throw(t))}catch(e){r(e)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(o,d)}l((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./global"),i=require("./ui"),n=require("../training"),s=require("../store"),r=1e3;class o{constructor(){this.content=null,this.restore=null,this.interval=null}toJSON(){}init(){return t(this,void 0,void 0,function*(){if(yield Promise.all([e.global.LOADED.TRAINING,e.global.LOADED.DICT,e.global.LOADED.STATS()]),!this.pool||this.pool.type!==e.global.SETTINGS.dict){const t=new s.Store("training",e.global.SETTINGS.dict);this.pool=yield n.TrainingPool.create(e.global.STATS,e.global.SETTINGS.dice,e.global.SETTINGS.dict,t,e.global.SETTINGS.min)}this.progress||(this.progress=i.UI.createElementWithId("div","progress"),this.updateProgress(),this.interval=setInterval(()=>this.updateProgress(),r))})}attach(){return t(this,void 0,void 0,function*(){return yield this.init(),this.train=i.UI.createElementWithId("div","train"),this.next(),this.train})}detach(){return t(this,void 0,void 0,function*(){return this.restore&&(yield this.restore()),this.interval&&clearInterval(this.interval),this.content=null,this.train})}next(){const t=i.UI.createElementWithId("div","content"),{label:e,group:n,update:s,restore:r}=this.pool.next();this.restore=r;const o=document.createElement("div");o.classList.add("word"),o.textContent=e;const d=i.UI.createElementWithId("div","sizeHint");d.style.visibility="hidden",d.textContent=String(n.length);const l=this.createRatingToggles(s),a=document.createElement("table");a.classList.add("results","hidden"),i.UI.addAnagramRows(a,n);const c=i.UI.createElementWithId("div","progress-wrapper");c.appendChild(this.progress),c.addEventListener("mouseup",()=>i.UI.toggleView("Review")),c.addEventListener("long-press",()=>{l.classList.contains("hidden")&&(d.style.visibility="visible")}),c.addEventListener("long-press-up",()=>{d.style.visibility="hidden"});const h=i.UI.createBackButton(()=>i.UI.toggleView("Menu"));t.appendChild(i.UI.createTopbar(h,null,c));const u=document.createElement("div");u.classList.add("wrapper"),u.appendChild(o),u.appendChild(a),t.appendChild(u),t.appendChild(d);const p=i.UI.createElementWithId("div","rating-wrapper");p.appendChild(l),t.appendChild(p);const g=e=>{[h,c,this.progress].includes(e.target)||(t.removeEventListener("click",g),o.classList.add("hidden"),d.classList.add("hidden"),a.classList.remove("hidden"),l.classList.remove("hidden"))};t.addEventListener("click",g),this.content&&this.train.removeChild(this.content),this.train.appendChild(t),this.content=t}createRatingToggles(e){const i=document.createElement("div");i.setAttribute("id","rating"),i.classList.add("toggle-group"),i.classList.add("horizontal"),i.classList.add("hidden");for(let n=0;n<6;n++){const s=document.createElement("button");s.setAttribute("id",`rating${n}`),s.setAttribute("type","button"),s.classList.add("toggle"),s.textContent=String(n),i.appendChild(s),s.addEventListener("click",()=>t(this,void 0,void 0,function*(){yield e(Number(s.textContent)),this.updateProgress(),this.restore=null,this.next()}))}return i}updateProgress(){this.progress.textContent=`${this.pool.overdue()} / ${this.pool.size}`}}exports.TrainingView=o;
},{"./global":"VlPw","./ui":"ePHQ","../training":"l4Rm","../store":"z7jk"}],"ePHQ":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n.throw(e))}catch(t){r(t)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(o,a)}d((n=n.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("./global"),i=require("../game"),n=require("../random"),s=require("../dict"),r=require("./board"),o=require("./score"),a=require("./define"),d=require("./menu"),c=require("./review"),h=require("./settings"),l=require("./stats"),u=require("./training");class m{attach(){this.loader=exports.UI.createElementWithId("div","loader");const e=exports.UI.createElementWithId("div","spinner");return this.loader.appendChild(e),this.loader}detach(){return this.loader}}exports.UI=new class{create(){return e(this,void 0,void 0,function*(){setTimeout(()=>window.scrollTo(0,1),0),(void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile"))&&setTimeout(()=>{const e=document.querySelector("meta[name=viewport]"),t=window.innerWidth,i=window.innerHeight;e.setAttribute("content",`width=${t}, height=${i}, initial-scale=1, user-scalable=no, minimal-ui`)},200),void 0!==t.global.SETTINGS.theme?this.setTheme(t.global.SETTINGS.theme):this.setTheme(window.matchMedia("(prefers-color-scheme: dark)").matches?"Dark":"Light"),this.root=document.getElementById("display");const e=JSON.parse(localStorage.getItem("state"));this.current=e?e.current:"Menu",this.previous=e?e.previous:"Menu",this.loader=new m;const i={Menu:d.MenuView,Board:r.BoardView,Training:u.TrainingView,Define:a.DefineView,Stats:l.StatsView,Settings:h.SettingsView},n=e?e.views:{};this.Views={};for(const[t,s]of Object.entries(i))this.Views[t]=new s(n[t]);this.Views.Review=new c.ReviewView(this.Views.Training),this.Views.Score=new o.ScoreView(this.Views.Board),yield this.setup(),this.BACK=document.createElement("img"),this.BACK.src=document.getElementById("svg").src,this.BACK.height=20,document.addEventListener("keydown",e=>this.onKeyDown(e)),document.addEventListener("swiped-left",()=>this.toggleView("Define")),document.addEventListener("swiped-right",()=>this.toggleView("Define")),window.addEventListener("hashchange",()=>this.onHashChange()),window.addEventListener("beforeunload",()=>this.persist()),yield this.attachView(this.current)})}persist(e=!1){const t=JSON.parse(localStorage.getItem("state"))||{};t.current=this.current,t.previous=this.previous,t.views=t.views||{},t.views[this.current]=this.Views[this.current],e&&(t.views[this.previous]=this.Views[this.previous]),localStorage.setItem("state",JSON.stringify(t))}attachView(t,i){return e(this,void 0,void 0,function*(){this.root.appendChild(this.loader.attach());const e=this.Views[t],n=yield e.attach(i);this.root.removeChild(this.loader.detach()),this.root.appendChild(n),e.afterAttach&&e.afterAttach()})}detachView(t,i){return e(this,void 0,void 0,function*(){this.root.removeChild(yield this.Views[t].detach(i))})}toggleView(t,i){return e(this,void 0,void 0,function*(){this.current===t?(yield this.detachView(t,this.previous),this.current=this.previous,this.previous=t,yield this.attachView(this.current,i)):(yield this.detachView(this.current,t),this.previous=this.current,this.current=t,yield this.attachView(t,i)),this.persist(!0)})}setup(){return e(this,void 0,void 0,function*(){const s=()=>e(this,void 0,void 0,function*(){if(yield t.global.LOADED.HISTORY,t.global.HISTORY.length){const e=t.global.HISTORY[t.global.HISTORY.length-1].seed,[s]=i.Game.decodeID(e),r=new n.Random;r.seed=t.global.SEED,r.next(),this.updateSettings(s,r.seed%t.global.MAX_SEED,!1)}}),r=document.location.hash&&document.location.hash.slice(1);if(r){const[e,t]=i.Game.decodeID(r);if(!this.valid(e,t))return s();this.updateSettings(e,t,!1)}else{const e=this.Views.Board.game;if(!e)return s();{const[t,n]=i.Game.decodeID(e.seed);this.updateSettings(t,n,!1)}}})}onKeyDown(t){return e(this,void 0,void 0,function*(){const e=t.keyCode,i=this.Views[this.current];191===e&&t.shiftKey?(t.preventDefault(),yield this.toggleView("Define")):"onKeyDown"in i&&(yield i.onKeyDown(t))})}onHashChange(){return e(this,void 0,void 0,function*(){if(!document.location.hash)return;const[e,n]=i.Game.decodeID(document.location.hash.slice(1));if(!this.valid(e,n))return;let s=n!==t.global.SEED;if(!s){const i=Object.assign({},t.global.SETTINGS);s=i.dice!==e.dice||i.min!==e.min||i.dict!==e.dict}if(this.updateSettings(e,n,!1),"Settings"===this.current)this.Views[this.current].update();else if(s&&["Board","Score"].includes(this.current))return this.Views.Board.refresh({new:!0,allowDupes:!0})})}valid(e,i){return!!(!isNaN(i)&&Number.isInteger(i)&&i<t.global.MAX_SEED&&e.dice&&e.dict&&e.min)}updateSettings(e,n,s=!0){Object.assign(t.global.SETTINGS,e),localStorage.setItem("settings",JSON.stringify(t.global.SETTINGS)),"number"==typeof n&&(t.global.SEED=n);const r=i.Game.encodeID(t.global.SETTINGS,t.global.SEED);if(window.history.replaceState(null,"",`#${r}`),s&&"Settings"===this.current){const e=this.Views[this.current];e.seed.textContent=r,e.seed.classList.remove("error")}}createElementWithId(e,t){const i=document.createElement(e);return i.setAttribute("id",t),i}createTopbar(e,t,i){const n=this.createElementWithId("header","topbar");return n.appendChild(e||document.createElement("div")),n.appendChild(t||document.createElement("div")),n.appendChild(i||document.createElement("div")),n}createBackButton(e){const t=this.createElementWithId("div","back");return t.appendChild(this.BACK),t.addEventListener("mouseup",e),t}createPlaceholder(){const e=this.createElementWithId("div","empty");return e.textContent="...",e}focusContentEditable(e){if(!document.body.contains(e))return;e.focus();const t=document.createRange();t.selectNodeContents(e),t.collapse(!1);const i=window.getSelection();i&&(i.removeAllRanges(),i.addRange(t))}permaFocus(e){e.addEventListener("blur",()=>setTimeout(()=>this.focusContentEditable(e),20)),this.focusContentEditable(e)}setTheme(e){document.documentElement.setAttribute("data-theme",e.toLowerCase())}addAnagramRows(e,i){for(const n of i){const i=n.replace(/[^A-Z]/,""),r=document.createElement("tr");t.global.STATS.stats(i,t.global.SETTINGS.dice,t.global.SETTINGS.dict).grade<t.global.SETTINGS.grade&&r.classList.add("hard");let o=document.createElement("td");const a=document.createElement("b"),d=n.startsWith("(")?`${n} `:n.endsWith(")")?` ${n}`:` ${n} `;a.textContent=` ${d} `,o.appendChild(a),r.appendChild(o),(o=document.createElement("td")).textContent=s.define(i,t.global.DICT),r.appendChild(o),e.appendChild(r)}}createRadios(e,t,i){const n=this.createElementWithId("span",e);n.classList.add("toggle-group"),n.classList.add("horizontal"),n.setAttribute("role","radiogroup");for(let s of t){let t=!1;Array.isArray(s)&&(t=!0,s=s[0]);const r=this.createElementWithId("input",`${e}${s}`);r.classList.add("hide"),r.setAttribute("type","radio"),r.setAttribute("name",e),r.setAttribute("value",s),t&&r.setAttribute("checked","checked");const o=document.createElement("label");o.classList.add("toggle"),o.setAttribute("for",`${e}${s}`),o.textContent=s.toUpperCase(),r.addEventListener("click",i.bind(r)),n.appendChild(r),n.appendChild(o)}return n}};
},{"./global":"VlPw","../game":"dgAm","../random":"Mkcc","../dict":"qafh","./board":"mx3t","./score":"LEQV","./define":"GDz3","./menu":"qI3H","./review":"AOXD","./settings":"UoCm","./stats":"PRMN","./training":"vUQU"}],"UK1B":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function s(t){try{l(n.next(t))}catch(e){i(e)}}function a(t){try{l(n.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(s,a)}l((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./global"),o=require("./ui"),n=require("../store"),r=require("../training"),i=require("../stats");exports.Debug=new class{backup(){return t(this,void 0,void 0,function*(){const t={history:yield e.global.STORE.get("history")};for(const e of["NWL","ENABLE","CSW"]){const o=new n.Store("training",e);t[e]=yield o.get("data")}return t.settings=JSON.parse(localStorage.getItem("settings")),JSON.stringify(t)})}restore(o){return t(this,void 0,void 0,function*(){yield e.global.STORE.set("history",o.history);for(const t of["NWL","ENABLE","CSW"]){const e=new n.Store("training",t);yield e.set("data",o[t])}localStorage.setItem("settings",JSON.stringify(o.settings))})}modify(o,s){return t(this,void 0,void 0,function*(){const t=new n.Store("training",e.global.SETTINGS.dict),a=yield r.TrainingPool.create(e.global.STATS,e.global.SETTINGS.dice,e.global.SETTINGS.dict,t,e.global.SETTINGS.min),l=i.Stats.toAnagram(o);let c;const g=a.learned,u=[];for(c=g.pop();c&&c.k!==l;c=g.pop())u.push(c);if(!c)throw RangeError();g.push(s(c));for(const e of u)g.push(e);return t.set("data",g.data)})}get state(){return JSON.parse(localStorage.getItem("state"))}},window.global=e.global,window.UI=o.UI,window.Debug=exports.Debug;
},{"./global":"VlPw","./ui":"ePHQ","../store":"z7jk","../training":"l4Rm","../stats":"Q9FA"}],"B6dB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("regenerator-runtime/runtime"),require("./swipe"),require("./longpress"),require("./ui/debug");const e=require("./ui/ui");e.UI.create();
},{"regenerator-runtime/runtime":"KA2S","./swipe":"CfsL","./longpress":"Wcnf","./ui/debug":"UK1B","./ui/ui":"ePHQ"}]},{},["B6dB"], null)
//# sourceMappingURL=src.e6f58385.js.map